<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Deploy ZIP API – Web UI</title>
  <link rel="stylesheet" href="/v1/deploy/ui/style.css" />
</head>
<body>
  <header>
    <h1>Deploy ZIP API – Web UI</h1>
    <p class="sub">ブラウザからアップロード/ダウンロード/履歴一覧が試せます。</p>
  </header>

  <main>
    <section class="card">
      <h2>接続先</h2>
      <div class="row">
        <label for="baseUrl">Base URL</label>
        <input id="baseUrl" type="text" value="" placeholder="例: http://localhost:8080" />
        <button id="btnUseCurrent">このページのoriginを使う</button>
      </div>
      <p class="hint">通常は同一origin（このページのorigin）でOKです。</p>
    </section>

    <section class="grid">
      <section class="card">
        <h2>アップロード（POST /v1/deploy/content）</h2>
        <p>SharePoint の「フォルダ一括ダウンロード」で作った ZIP（トップにフォルダ1つ）を指定してください。</p>
        <input id="file" type="file" accept=".zip,application/zip" />
        <div class="row">
          <button id="btnUpload">アップロードして差し替え</button>
          <span id="uploadStatus" class="status"></span>
        </div>
        <details>
          <summary>curl コマンド</summary>
          <pre id="curlUpload" class="code"></pre>
        </details>
      </section>

      <section class="card">
        <h2>ダウンロード（GET）</h2>
        <div class="row">
          <button id="btnDownloadContent">現行コンテンツをZIPで取得（GET /v1/deploy/content）</button>
        </div>
        <div class="row">
          <button id="btnRefresh">履歴一覧を更新（GET /v1/deploy/archive）</button>
          <span id="listStatus" class="status"></span>
        </div>
        <div>
          <table>
            <thead>
              <tr><th>id</th><th>mtime</th><th>download</th></tr>
            </thead>
            <tbody id="archiveRows"></tbody>
          </table>
        </div>
        <details>
          <summary>curl コマンド</summary>
          <pre id="curlDownload" class="code"></pre>
        </details>
      </section>
    </section>

    <section class="card">
      <h2>ドキュメント / OpenAPI</h2>
      <ul>
        <li><a id="linkDocs" href="/v1/deploy/docs" target="_blank" rel="noreferrer">/docs (Markdown)</a></li>
        <li><a id="linkYaml" href="/v1/deploy/openapi.yaml" target="_blank" rel="noreferrer">/openapi.yaml</a></li>
        <li><a id="linkJson" href="/v1/deploy/openapi.json" target="_blank" rel="noreferrer">/openapi.json</a></li>
        <li><a id="linkHealth" href="/v1/deploy/healthz" target="_blank" rel="noreferrer">/healthz</a></li>
      </ul>
      <p class="hint">Swagger UI/Redoc を使う場合は、この OpenAPI を読み込んでください。</p>
    </section>

    <section class="card">
      <h2>ログ</h2>
      <pre id="log" class="log"></pre>
    </section>
  </main>

  <footer>
    <span class="muted">deploy-zip-api</span>
  </footer>

  <script src="/v1/deploy/ui/app.js"></script>
</body>
</html>
